# %%
from dotenv import load_dotenv
import os
from pydalle import Dalle


# %%
# Configure the Dalle-2 API client
load_dotenv("../")
OPENAI_USERNAME = os.getenv("OPENAI_USERNAME")
OPENAI_PASSWORD = os.getenv("OPENAI_PASSWORD")
client = Dalle(OPENAI_USERNAME, OPENAI_PASSWORD)

# %%
# Download and visualize recent images generated by my Dalle-2 account
print("Attempting to download a generation of the first task and show off some built-in helpers...")
tasks = client.get_tasks(limit=5)
if tasks and tasks[0].generations:
    example = tasks[0].generations[0].download()
    example.to_pil().save("1.png")
    example.to_pil().show()

# %%
print("DO NOT RUN THIS! IT WILL COST $$$")
exit()
# print("Attempting to do a text2im task...")
# completed_text2im_task = client.text2im("Cat Santa Claus")
# for image in completed_text2im_task.download():
#     image.to_pil().show()